# ZephyrUI DDDåˆ†å±‚æ¶æ„è®¾è®¡ä¸å¯è§‚æµ‹æ€§ä½“ç³»

## ğŸ—ï¸ DDDåˆ†å±‚æ¶æ„è®¾è®¡

### æ¶æ„æ€»è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            Presentation Layer                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚   Widgets   â”‚ â”‚   Pages     â”‚ â”‚ Navigators  â”‚ â”‚   Themes    â”‚       â”‚
â”‚  â”‚  (Components)â”‚ â”‚  (Screens)  â”‚ â”‚  (Routing)  â”‚ â”‚  (Styling)  â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           Application Layer                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚  Services   â”‚ â”‚  Use Cases  â”‚ â”‚ ViewModels  â”‚ â”‚ Controllers â”‚       â”‚
â”‚  â”‚ (Business)  â”‚ â”‚ (Workflows)  â”‚ â”‚ (State)     â”‚ â”‚ (API)       â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              Domain Layer                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚  Entities   â”‚ â”‚Value Objectsâ”‚ â”‚ Aggregates  â”‚ â”‚  Events     â”‚       â”‚
â”‚  â”‚  (Models)   â”‚ â”‚  (Types)    â”‚ â”‚ (Roots)     â”‚ â”‚ (Domain)    â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Infrastructure Layer                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚   Repositoriesâ”‚ â”‚  External   â”‚ â”‚  Utilities  â”‚ â”‚  Security   â”‚       â”‚
â”‚  â”‚   (Data)     â”‚ â”‚  APIs       â”‚ â”‚  (Helpers)  â”‚ â”‚  (Auth)     â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1. Presentation Layer (è¡¨ç°å±‚)

#### 1.1 Widget Architecture
```dart
// åŸºç¡€WidgetæŠ½è±¡ç±»
abstract class ZephyrWidget extends StatelessWidget {
  const ZephyrWidget({super.key});
  
  @override
  Widget build(BuildContext context) {
    return _buildWithPerformance(context);
  }
  
  Widget _buildWithPerformance(BuildContext context) {
    return ZephyrPerformanceWidget(
      widgetName: runtimeType.toString(),
      child: buildWidget(context),
    );
  }
  
  @protected
  Widget buildWidget(BuildContext context);
}

// çŠ¶æ€ç®¡ç†WidgetåŸºç±»
abstract class ZephyrStatefulWidget extends StatefulWidget {
  const ZephyrStatefulWidget({super.key});
  
  @override
  State<ZephyrStatefulWidget> createState();
}

abstract class ZephyrState<T extends ZephyrStatefulWidget> extends State<T> {
  @override
  Widget build(BuildContext context) {
    return ZephyrPerformanceWidget(
      widgetName: widget.runtimeType.toString(),
      child: buildWidget(context),
    );
  }
  
  @protected
  Widget buildWidget(BuildContext context);
}
```

#### 1.2 Theme System
```dart
// ä¸»é¢˜æ•°æ®ç»“æ„
class ZephyrThemeData {
  final ZephyrColorScheme colorScheme;
  final ZephyrTextTheme textTheme;
  final ZephyrSpacing spacing;
  final ZephyrBorderRadius borderRadius;
  final ZephyrShadows shadows;
  final ZephyrAnimations animations;
  
  const ZephyrThemeData({
    required this.colorScheme,
    required this.textTheme,
    required this.spacing,
    required this.borderRadius,
    required this.shadows,
    required this.animations,
  });
  
  ZephyrThemeData copyWith({
    ZephyrColorScheme? colorScheme,
    ZephyrTextTheme? textTheme,
    ZephyrSpacing? spacing,
    ZephyrBorderRadius? borderRadius,
    ZephyrShadows? shadows,
    ZephyrAnimations? animations,
  }) {
    return ZephyrThemeData(
      colorScheme: colorScheme ?? this.colorScheme,
      textTheme: textTheme ?? this.textTheme,
      spacing: spacing ?? this.spacing,
      borderRadius: borderRadius ?? this.borderRadius,
      shadows: shadows ?? this.shadows,
      animations: animations ?? this.animations,
    );
  }
}

// ä¸»é¢˜æ‰©å±•
class ZephyrTheme extends InheritedWidget {
  final ZephyrThemeData data;
  
  const ZephyrTheme({
    required this.data,
    required super.child,
    super.key,
  });
  
  static ZephyrThemeData of(BuildContext context) {
    final theme = context.dependOnInheritedWidgetOfExactType<ZephyrTheme>();
    return theme?.data ?? ZephyrThemeData.fallback();
  }
  
  @override
  bool updateShouldNotify(ZephyrTheme oldWidget) {
    return data != oldWidget.data;
  }
}
```

#### 1.3 Component Registry
```dart
// ç»„ä»¶æ³¨å†Œä¸­å¿ƒ
class ZephyrComponentRegistry {
  static final Map<String, ZephyrComponentFactory> _factories = {};
  static final Map<String, ZephyrComponentMetadata> _metadata = {};
  
  static void register<T extends ZephyrWidget>({
    required String name,
    required ZephyrComponentFactory<T> factory,
    required ZephyrComponentMetadata metadata,
  }) {
    _factories[name] = factory;
    _metadata[name] = metadata;
  }
  
  static T create<T extends ZephyrWidget>(String name, Map<String, dynamic> params) {
    final factory = _factories[name] as ZephyrComponentFactory<T>?;
    if (factory == null) {
      throw StateError('Component $name not registered');
    }
    return factory(params);
  }
  
  static ZephyrComponentMetadata? getMetadata(String name) {
    return _metadata[name];
  }
  
  static List<String> getRegisteredComponents() {
    return _factories.keys.toList();
  }
}
```

### 2. Application Layer (åº”ç”¨å±‚)

#### 2.1 Use Cases
```dart
// Use CaseåŸºç±»
abstract class ZephyrUseCase<T, P> {
  Future<ZephyrResult<T>> execute(P params);
}

// ä¸»é¢˜åˆ‡æ¢Use Case
class ZephyrChangeThemeUseCase extends ZephyrUseCase<void, ZephyrThemeParams> {
  final ZephyrThemeRepository _themeRepository;
  
  ZephyrChangeThemeUseCase(this._themeRepository);
  
  @override
  Future<ZephyrResult<void>> execute(ZephyrThemeParams params) async {
    try {
      await _themeRepository.saveTheme(params.themeData);
      return ZephyrResult.success(null);
    } catch (e) {
      return ZephyrResult.failure(ZephyrError(
        code: 'THEME_CHANGE_FAILED',
        message: 'Failed to change theme: ${e.toString()}',
      ));
    }
  }
}

// ç»„ä»¶é…ç½®Use Case
class ZephyrConfigureComponentUseCase extends ZephyrUseCase<void, ZephyrComponentConfig> {
  final ZephyrComponentRepository _componentRepository;
  
  ZephyrConfigureComponentUseCase(this._componentRepository);
  
  @override
  Future<ZephyrResult<void>> execute(ZephyrComponentConfig config) async {
    try {
      await _componentRepository.saveConfig(config);
      return ZephyrResult.success(null);
    } catch (e) {
      return ZephyrResult.failure(ZephyrError(
        code: 'CONFIG_SAVE_FAILED',
        message: 'Failed to save component config: ${e.toString()}',
      ));
    }
  }
}
```

#### 2.2 ViewModels
```dart
// ViewModelåŸºç±»
abstract class ZephyrViewModel extends ChangeNotifier {
  bool _isLoading = false;
  ZephyrError? _error;
  
  bool get isLoading => _isLoading;
  ZephyrError? get error => _error;
  
  void setLoading(bool loading) {
    if (_isLoading != loading) {
      _isLoading = loading;
      notifyListeners();
    }
  }
  
  void setError(ZephyrError? error) {
    if (_error != error) {
      _error = error;
      notifyListeners();
    }
  }
  
  void clearError() {
    setError(null);
  }
  
  @protected
  Future<T> executeUseCase<T, P>(
    ZephyrUseCase<T, P> useCase,
    P params, {
    bool showLoading = true,
  }) async {
    try {
      if (showLoading) {
        setLoading(true);
        clearError();
      }
      
      final result = await useCase.execute(params);
      
      if (result.isFailure) {
        setError(result.error);
        return Future.error(result.error!);
      }
      
      return result.data!;
    } finally {
      if (showLoading) {
        setLoading(false);
      }
    }
  }
}

// ä¸»é¢˜ViewModel
class ZephyrThemeViewModel extends ZephyrViewModel {
  final ZephyrChangeThemeUseCase _changeThemeUseCase;
  final ZephyrGetThemeUseCase _getThemeUseCase;
  
  ZephyrThemeData? _currentTheme;
  
  ZephyrThemeData? get currentTheme => _currentTheme;
  
  ZephyrThemeViewModel(
    this._changeThemeUseCase,
    this._getThemeUseCase,
  );
  
  Future<void> loadTheme() async {
    try {
      final theme = await executeUseCase(_getThemeUseCase, null);
      _currentTheme = theme;
      notifyListeners();
    } catch (e) {
      // Error already handled by base class
    }
  }
  
  Future<void> changeTheme(ZephyrThemeData theme) async {
    try {
      await executeUseCase(
        _changeThemeUseCase,
        ZephyrThemeParams(themeData: theme),
      );
      _currentTheme = theme;
      notifyListeners();
    } catch (e) {
      // Error already handled by base class
    }
  }
}
```

#### 2.3 Services
```dart
// æœåŠ¡æ¥å£
abstract class ZephyrAnalyticsService {
  Future<void> trackEvent(String name, Map<String, dynamic> properties);
  Future<void> trackError(ZephyrError error);
  Future<void> trackPerformance(String metric, double value);
}

// æœåŠ¡å®ç°
class ZephyrAnalyticsServiceImpl implements ZephyrAnalyticsService {
  final ZephyrAnalyticsRepository _repository;
  
  ZephyrAnalyticsServiceImpl(this._repository);
  
  @override
  Future<void> trackEvent(String name, Map<String, dynamic> properties) async {
    try {
      await _repository.logEvent(name, properties);
    } catch (e) {
      // Silent fail for analytics
      debugPrint('Failed to track event: $e');
    }
  }
  
  @override
  Future<void> trackError(ZephyrError error) async {
    try {
      await _repository.logError(error);
    } catch (e) {
      debugPrint('Failed to track error: $e');
    }
  }
  
  @override
  Future<void> trackPerformance(String metric, double value) async {
    try {
      await _repository.logPerformance(metric, value);
    } catch (e) {
      debugPrint('Failed to track performance: $e');
    }
  }
}
```

### 3. Domain Layer (é¢†åŸŸå±‚)

#### 3.1 Entities
```dart
// ç»„ä»¶å®ä½“
class ZephyrComponent {
  final String id;
  final String name;
  final String type;
  final ZephyrComponentConfig config;
  final DateTime createdAt;
  final DateTime updatedAt;
  
  ZephyrComponent({
    required this.id,
    required this.name,
    required this.type,
    required this.config,
    required this.createdAt,
    required this.updatedAt,
  });
  
  ZephyrComponent copyWith({
    String? id,
    String? name,
    String? type,
    ZephyrComponentConfig? config,
    DateTime? createdAt,
    DateTime? updatedAt,
  }) {
    return ZephyrComponent(
      id: id ?? this.id,
      name: name ?? this.name,
      type: type ?? this.type,
      config: config ?? this.config,
      createdAt: createdAt ?? this.createdAt,
      updatedAt: updatedAt ?? this.updatedAt,
    );
  }
  
  @override
  bool operator ==(Object other) {
    if (identical(this, other)) return true;
    return other is ZephyrComponent &&
        other.id == id &&
        other.name == name &&
        other.type == type &&
        other.config == config &&
        other.createdAt == createdAt &&
        other.updatedAt == updatedAt;
  }
  
  @override
  int get hashCode {
    return Object.hash(
      id,
      name,
      type,
      config,
      createdAt,
      updatedAt,
    );
  }
}
```

#### 3.2 Value Objects
```dart
// é¢œè‰²å€¼å¯¹è±¡
class ZephyrColor {
  final int value;
  final String name;
  
  const ZephyrColor(this.value, this.name);
  
  factory ZephyrColor.fromHex(String hex) {
    final color = int.parse(hex.replaceFirst('#', ''), radix: 16);
    return ZephyrColor(color, hex);
  }
  
  Color get materialColor => Color(value);
  
  String get hex => '#${value.toRadixString(16).padLeft(8, '0')}';
  
  ZephyrColor withOpacity(double opacity) {
    return ZephyrColor(
      (value & 0x00FFFFFF) | ((opacity * 255).toInt() << 24),
      name,
    );
  }
  
  @override
  bool operator ==(Object other) {
    if (identical(this, other)) return true;
    return other is ZephyrColor && other.value == value;
  }
  
  @override
  int get hashCode => value.hashCode;
}

// é—´è·å€¼å¯¹è±¡
class ZephyrSpacing {
  final double xs;
  final double sm;
  final double md;
  final double lg;
  final double xl;
  final double xxl;
  
  const ZephyrSpacing({
    required this.xs,
    required this.sm,
    required this.md,
    required this.lg,
    required this.xl,
    required this.xxl,
  });
  
  factory ZephyrSpacing.uniform(double value) {
    return ZephyrSpacing(
      xs: value * 0.25,
      sm: value * 0.5,
      md: value,
      lg: value * 1.5,
      xl: value * 2,
      xxl: value * 3,
    );
  }
  
  double get(ZephyrSize size) {
    switch (size) {
      case ZephyrSize.xs:
        return xs;
      case ZephyrSize.sm:
        return sm;
      case ZephyrSize.md:
        return md;
      case ZephyrSize.lg:
        return lg;
      case ZephyrSize.xl:
        return xl;
    }
  }
}
```

#### 3.3 Aggregates
```dart
// ä¸»é¢˜èšåˆæ ¹
class ZephyrThemeAggregate {
  final String id;
  final String name;
  final ZephyrThemeData themeData;
  final List<ZephyrComponent> components;
  final DateTime createdAt;
  final DateTime updatedAt;
  
  ZephyrThemeAggregate({
    required this.id,
    required this.name,
    required this.themeData,
    required this.components,
    required this.createdAt,
    required this.updatedAt,
  });
  
  // ä¸šåŠ¡è§„åˆ™ï¼šä¸»é¢˜åç§°ä¸èƒ½ä¸ºç©º
  bool get isValid => name.isNotEmpty;
  
  // ä¸šåŠ¡æ–¹æ³•ï¼šæ·»åŠ ç»„ä»¶
  ZephyrThemeAggregate addComponent(ZephyrComponent component) {
    if (components.any((c) => c.id == component.id)) {
      throw ArgumentError('Component with id ${component.id} already exists');
    }
    
    return copyWith(
      components: [...components, component],
      updatedAt: DateTime.now(),
    );
  }
  
  // ä¸šåŠ¡æ–¹æ³•ï¼šç§»é™¤ç»„ä»¶
  ZephyrThemeAggregate removeComponent(String componentId) {
    final updatedComponents = components.where((c) => c.id != componentId).toList();
    
    if (updatedComponents.length == components.length) {
      throw ArgumentError('Component with id $componentId not found');
    }
    
    return copyWith(
      components: updatedComponents,
      updatedAt: DateTime.now(),
    );
  }
  
  // ä¸šåŠ¡æ–¹æ³•ï¼šæ›´æ–°ä¸»é¢˜æ•°æ®
  ZephyrThemeAggregate updateThemeData(ZephyrThemeData newThemeData) {
    return copyWith(
      themeData: newThemeData,
      updatedAt: DateTime.now(),
    );
  }
  
  ZephyrThemeAggregate copyWith({
    String? id,
    String? name,
    ZephyrThemeData? themeData,
    List<ZephyrComponent>? components,
    DateTime? createdAt,
    DateTime? updatedAt,
  }) {
    return ZephyrThemeAggregate(
      id: id ?? this.id,
      name: name ?? this.name,
      themeData: themeData ?? this.themeData,
      components: components ?? this.components,
      createdAt: createdAt ?? this.createdAt,
      updatedAt: updatedAt ?? this.updatedAt,
    );
  }
}
```

#### 3.4 Domain Events
```dart
// é¢†åŸŸäº‹ä»¶åŸºç±»
abstract class ZephyrDomainEvent {
  final String id;
  final DateTime occurredAt;
  final Map<String, dynamic> metadata;
  
  ZephyrDomainEvent({
    required this.id,
    required this.occurredAt,
    this.metadata = const {},
  });
}

// ä¸»é¢˜å˜æ›´äº‹ä»¶
class ZephyrThemeChangedEvent extends ZephyrDomainEvent {
  final String themeId;
  final String themeName;
  final ZephyrThemeData oldThemeData;
  final ZephyrThemeData newThemeData;
  
  ZephyrThemeChangedEvent({
    required this.themeId,
    required this.themeName,
    required this.oldThemeData,
    required this.newThemeData,
    String? id,
    DateTime? occurredAt,
    Map<String, dynamic> metadata = const {},
  }) : super(
          id: id ?? const Uuid().v4(),
          occurredAt: occurredAt ?? DateTime.now(),
          metadata: metadata,
        );
}

// ç»„ä»¶é…ç½®å˜æ›´äº‹ä»¶
class ZephyrComponentConfigChangedEvent extends ZephyrDomainEvent {
  final String componentId;
  final String componentName;
  final ZephyrComponentConfig oldConfig;
  final ZephyrComponentConfig newConfig;
  
  ZephyrComponentConfigChangedEvent({
    required this.componentId,
    required this.componentName,
    required this.oldConfig,
    required this.newConfig,
    String? id,
    DateTime? occurredAt,
    Map<String, dynamic> metadata = const {},
  }) : super(
          id: id ?? const Uuid().v4(),
          occurredAt: occurredAt ?? DateTime.now(),
          metadata: metadata,
        );
}

// äº‹ä»¶å‘å¸ƒå™¨
class ZephyrDomainEventPublisher {
  static final Map<Type, List<Function>> _handlers = {};
  
  static void subscribe<T extends ZephyrDomainEvent>(void Function(T) handler) {
    _handlers[T] ??= [];
    _handlers[T]!.add(handler);
  }
  
  static void publish<T extends ZephyrDomainEvent>(T event) {
    if (_handlers.containsKey(T)) {
      for (final handler in _handlers[T]!) {
        handler(event as T);
      }
    }
  }
  
  static void unsubscribe<T extends ZephyrDomainEvent>(void Function(T) handler) {
    _handlers[T]?.remove(handler);
  }
}
```

### 4. Infrastructure Layer (åŸºç¡€è®¾æ–½å±‚)

#### 4.1 Repositories
```dart
// ä¸»é¢˜ä»“åº“æ¥å£
abstract class ZephyrThemeRepository {
  Future<ZephyrThemeData?> getTheme();
  Future<void> saveTheme(ZephyrThemeData themeData);
  Future<void> deleteTheme();
  Stream<ZephyrThemeData?> watchTheme();
}

// æœ¬åœ°å­˜å‚¨å®ç°
class ZephyrThemeLocalRepository implements ZephyrThemeRepository {
  final SharedPreferences _prefs;
  final String _key = 'zephyr_theme';
  
  ZephyrThemeLocalRepository(this._prefs);
  
  @override
  Future<ZephyrThemeData?> getTheme() async {
    final themeJson = _prefs.getString(_key);
    if (themeJson == null) return null;
    
    try {
      final themeMap = json.decode(themeJson) as Map<String, dynamic>;
      return ZephyrThemeData.fromJson(themeMap);
    } catch (e) {
      debugPrint('Failed to parse theme data: $e');
      return null;
    }
  }
  
  @override
  Future<void> saveTheme(ZephyrThemeData themeData) async {
    final themeJson = json.encode(themeData.toJson());
    await _prefs.setString(_key, themeJson);
  }
  
  @override
  Future<void> deleteTheme() async {
    await _prefs.remove(_key);
  }
  
  @override
  Stream<ZephyrThemeData?> watchTheme() {
    return _prefs.getString(_key).asBroadcastStream().map((themeJson) {
      if (themeJson == null) return null;
      try {
        final themeMap = json.decode(themeJson) as Map<String, dynamic>;
        return ZephyrThemeData.fromJson(themeMap);
      } catch (e) {
        debugPrint('Failed to parse theme data: $e');
        return null;
      }
    });
  }
}
```

#### 4.2 External APIs
```dart
// åˆ†ææœåŠ¡æ¥å£
abstract class ZephyrAnalyticsRepository {
  Future<void> logEvent(String name, Map<String, dynamic> properties);
  Future<void> logError(ZephyrError error);
  Future<void> logPerformance(String metric, double value);
}

// Firebaseåˆ†æå®ç°
class ZephyrFirebaseAnalyticsRepository implements ZephyrAnalyticsRepository {
  final FirebaseAnalytics _analytics;
  
  ZephyrFirebaseAnalyticsRepository(this._analytics);
  
  @override
  Future<void> logEvent(String name, Map<String, dynamic> properties) async {
    await _analytics.logEvent(
      name: name,
      parameters: properties,
    );
  }
  
  @override
  Future<void> logError(ZephyrError error) async {
    await FirebaseCrashlytics.instance.recordError(
      error,
      StackTrace.current,
      reason: error.message,
    );
  }
  
  @override
  Future<void> logPerformance(String metric, double value) async {
    await _analytics.logEvent(
      name: 'performance',
      parameters: {
        'metric': metric,
        'value': value,
      },
    );
  }
}
```

#### 4.3 Security Services
```dart
// å®‰å…¨æœåŠ¡æ¥å£
abstract class ZephyrSecurityService {
  Future<bool> authenticate(String username, String password);
  Future<void> logout();
  Future<bool> hasPermission(String permission);
  Future<String> generateToken();
  Future<bool> validateToken(String token);
}

// å®‰å…¨æœåŠ¡å®ç°
class ZephyrSecurityServiceImpl implements ZephyrSecurityService {
  final ZephyrAuthRepository _authRepository;
  
  ZephyrSecurityServiceImpl(this._authRepository);
  
  @override
  Future<bool> authenticate(String username, String password) async {
    try {
      final credentials = ZephyrCredentials(
        username: username,
        password: _hashPassword(password),
      );
      
      final result = await _authRepository.authenticate(credentials);
      return result != null;
    } catch (e) {
      return false;
    }
  }
  
  @override
  Future<void> logout() async {
    await _authRepository.clearCredentials();
  }
  
  @override
  Future<bool> hasPermission(String permission) async {
    final user = await _authRepository.getCurrentUser();
    return user?.permissions.contains(permission) ?? false;
  }
  
  @override
  Future<String> generateToken() async {
    final user = await _authRepository.getCurrentUser();
    if (user == null) {
      throw StateError('No authenticated user');
    }
    
    return _generateJwtToken(user);
  }
  
  @override
  Future<bool> validateToken(String token) async {
    try {
      final decoded = _decodeJwtToken(token);
      final user = await _authRepository.getCurrentUser();
      return user?.id == decoded['userId'];
    } catch (e) {
      return false;
    }
  }
  
  String _hashPassword(String password) {
    // å®ç°å¯†ç å“ˆå¸Œ
    return password; // ç®€åŒ–ç¤ºä¾‹
  }
  
  String _generateJwtToken(ZephyrUser user) {
    // å®ç°JWTç”Ÿæˆ
    return 'token_${user.id}_${DateTime.now().millisecondsSinceEpoch}';
  }
  
  Map<String, dynamic> _decodeJwtToken(String token) {
    // å®ç°JWTè§£ç 
    return {'userId': token.split('_')[1]};
  }
}
```

## ğŸ“Š å¯è§‚æµ‹æ€§æŒ‡æ ‡ä½“ç³»

### 1. æ€§èƒ½ç›‘æ§æŒ‡æ ‡

#### 1.1 æ¸²æŸ“æ€§èƒ½æŒ‡æ ‡
```dart
// æ¸²æŸ“æ€§èƒ½ç›‘æ§
class ZephyrRenderingMetrics {
  static final Map<String, List<double>> _frameTimes = {};
  static final Map<String, List<double>> _buildTimes = {};
  
  static void recordFrameTime(String widgetName, double frameTime) {
    _frameTimes[widgetName] ??= [];
    _frameTimes[widgetName]!.add(frameTime);
  }
  
  static void recordBuildTime(String widgetName, double buildTime) {
    _buildTimes[widgetName] ??= [];
    _buildTimes[widgetName]!.add(buildTime);
  }
  
  static Map<String, double> getAverageFrameTimes() {
    return _frameTimes.map((key, times) {
      return MapEntry(key, times.reduce((a, b) => a + b) / times.length);
    });
  }
  
  static Map<String, double> getAverageBuildTimes() {
    return _buildTimes.map((key, times) {
      return MapEntry(key, times.reduce((a, b) => a + b) / times.length);
    });
  }
  
  static ZephyrRenderingReport generateReport() {
    return ZephyrRenderingReport(
      averageFrameTimes: getAverageFrameTimes(),
      averageBuildTimes: getAverageBuildTimes(),
      worstPerformingWidgets: _getWorstPerformingWidgets(),
      timestamp: DateTime.now(),
    );
  }
  
  static List<String> _getWorstPerformingWidgets() {
    final frameTimes = getAverageFrameTimes();
    return frameTimes.entries
        .where((entry) => entry.value > 16.0) // è¶…è¿‡16ms
        .map((entry) => entry.key)
        .toList()
        ..sort((a, b) => frameTimes[b]!.compareTo(frameTimes[a]!));
  }
}
```

#### 1.2 å†…å­˜ä½¿ç”¨æŒ‡æ ‡
```dart
// å†…å­˜ä½¿ç”¨ç›‘æ§
class ZephyrMemoryMetrics {
  static final Map<String, double> _memoryUsage = {};
  static final Map<String, int> _objectCounts = {};
  
  static void recordMemoryUsage(String category, double usageMB) {
    _memoryUsage[category] = usageMB;
  }
  
  static void recordObjectCount(String type, int count) {
    _objectCounts[type] = count;
  }
  
  static double getTotalMemoryUsage() {
    return _memoryUsage.values.fold(0, (sum, usage) => sum + usage);
  }
  
  static int getTotalObjectCount() {
    return _objectCounts.values.fold(0, (sum, count) => sum + count);
  }
  
  static ZephyrMemoryReport generateReport() {
    return ZephyrMemoryReport(
      totalMemoryUsage: getTotalMemoryUsage(),
      totalObjectCount: getTotalObjectCount(),
      memoryByCategory: Map.from(_memoryUsage),
      objectCountsByType: Map.from(_objectCounts),
      timestamp: DateTime.now(),
    );
  }
  
  static void checkMemoryLeaks() {
    final currentUsage = getTotalMemoryUsage();
    if (currentUsage > 100.0) { // 100MBé˜ˆå€¼
      ZephyrLogger.warning('High memory usage detected: ${currentUsage}MB');
    }
  }
}
```

#### 1.3 ç½‘ç»œæ€§èƒ½æŒ‡æ ‡
```dart
// ç½‘ç»œæ€§èƒ½ç›‘æ§
class ZephyrNetworkMetrics {
  static final Map<String, List<double>> _requestTimes = {};
  static final Map<String, int> _errorCounts = {};
  
  static void recordRequestTime(String endpoint, double requestTime) {
    _requestTimes[endpoint] ??= [];
    _requestTimes[endpoint]!.add(requestTime);
  }
  
  static void recordError(String endpoint) {
    _errorCounts[endpoint] = (_errorCounts[endpoint] ?? 0) + 1;
  }
  
  static Map<String, double> getAverageRequestTimes() {
    return _requestTimes.map((key, times) {
      return MapEntry(key, times.reduce((a, b) => a + b) / times.length);
    });
  }
  
  static Map<String, double> getErrorRates() {
    return _errorCounts.map((endpoint, errorCount) {
      final totalRequests = _requestTimes[endpoint]?.length ?? 0;
      final errorRate = totalRequests > 0 ? errorCount / totalRequests : 0.0;
      return MapEntry(endpoint, errorRate);
    });
  }
  
  static ZephyrNetworkReport generateReport() {
    return ZephyrNetworkReport(
      averageRequestTimes: getAverageRequestTimes(),
      errorRates: getErrorRates(),
      totalRequests: _requestTimes.values.fold(0, (sum, times) => sum + times.length),
      totalErrors: _errorCounts.values.fold(0, (sum, count) => sum + count),
      timestamp: DateTime.now(),
    );
  }
}
```

### 2. ä¸šåŠ¡ç›‘æ§æŒ‡æ ‡

#### 2.1 ç”¨æˆ·è¡Œä¸ºæŒ‡æ ‡
```dart
// ç”¨æˆ·è¡Œä¸ºç›‘æ§
class ZephyrUserBehaviorMetrics {
  static final Map<String, int> _eventCounts = {};
  static final Map<String, List<Duration>> _sessionDurations = {};
  
  static void recordEvent(String eventName) {
    _eventCounts[eventName] = (_eventCounts[eventName] ?? 0) + 1;
  }
  
  static void recordSessionDuration(String userId, Duration duration) {
    _sessionDurations[userId] ??= [];
    _sessionDurations[userId]!.add(duration);
  }
  
  static Map<String, int> getEventCounts() {
    return Map.from(_eventCounts);
  }
  
  static double getAverageSessionDuration() {
    final allDurations = _sessionDurations.values.expand((durations) => durations);
    if (allDurations.isEmpty) return 0.0;
    
    final totalDuration = allDurations.fold(
      Duration.zero,
      (sum, duration) => sum + duration,
    );
    return totalDuration.inMilliseconds / allDurations.length / 1000.0;
  }
  
  static ZephyrUserBehaviorReport generateReport() {
    return ZephyrUserBehaviorReport(
      eventCounts: getEventCounts(),
      averageSessionDuration: getAverageSessionDuration(),
      totalEvents: _eventCounts.values.fold(0, (sum, count) => sum + count),
      totalSessions: _sessionDurations.length,
      timestamp: DateTime.now(),
    );
  }
}
```

#### 2.2 ç»„ä»¶ä½¿ç”¨æŒ‡æ ‡
```dart
// ç»„ä»¶ä½¿ç”¨ç›‘æ§
class ZephyrComponentUsageMetrics {
  static final Map<String, int> _componentUsage = {};
  static final Map<String, List<double>> _renderTimes = {};
  
  static void recordComponentUsage(String componentName) {
    _componentUsage[componentName] = (_componentUsage[componentName] ?? 0) + 1;
  }
  
  static void recordComponentRenderTime(String componentName, double renderTime) {
    _renderTimes[componentName] ??= [];
    _renderTimes[componentName]!.add(renderTime);
  }
  
  static Map<String, int> getComponentUsageCounts() {
    return Map.from(_componentUsage);
  }
  
  static Map<String, double> getAverageRenderTimes() {
    return _renderTimes.map((key, times) {
      return MapEntry(key, times.reduce((a, b) => a + b) / times.length);
    });
  }
  
  static List<String> getMostUsedComponents({int limit = 10}) {
    return _componentUsage.entries
        .map((entry) => MapEntry(entry.key, entry.value))
        .toList()
        ..sort((a, b) => b.value.compareTo(a.value));
  }
  
  static ZephyrComponentUsageReport generateReport() {
    return ZephyrComponentUsageReport(
      componentUsageCounts: getComponentUsageCounts(),
      averageRenderTimes: getAverageRenderTimes(),
      mostUsedComponents: getMostUsedComponents(),
      totalComponentUsages: _componentUsage.values.fold(0, (sum, count) => sum + count),
      timestamp: DateTime.now(),
    );
  }
}
```

### 3. å¥åº·æ£€æŸ¥ç³»ç»Ÿ

#### 3.1 ç³»ç»Ÿå¥åº·æ£€æŸ¥
```dart
// ç³»ç»Ÿå¥åº·æ£€æŸ¥
class ZephyrHealthChecker {
  static final List<ZephyrHealthCheck> _checks = [];
  
  static void registerCheck(ZephyrHealthCheck check) {
    _checks.add(check);
  }
  
  static Future<ZephyrHealthReport> runChecks() async {
    final results = <String, ZephyrHealthCheckResult>{};
    
    for (final check in _checks) {
      try {
        final result = await check.run();
        results[check.name] = result;
      } catch (e) {
        results[check.name] = ZephyrHealthCheckResult(
          status: ZephyrHealthStatus.unhealthy,
          message: 'Check failed: ${e.toString()}',
        );
      }
    }
    
    return ZephyrHealthReport(
      results: results,
      overallStatus: _calculateOverallStatus(results),
      timestamp: DateTime.now(),
    );
  }
  
  static ZephyrHealthStatus _calculateOverallStatus(
    Map<String, ZephyrHealthCheckResult> results,
  ) {
    if (results.values.any((result) => result.status == ZephyrHealthStatus.unhealthy)) {
      return ZephyrHealthStatus.unhealthy;
    }
    
    if (results.values.any((result) => result.status == ZephyrHealthStatus.degraded)) {
      return ZephyrHealthStatus.degraded;
    }
    
    return ZephyrHealthStatus.healthy;
  }
}

// å¥åº·æ£€æŸ¥åŸºç±»
abstract class ZephyrHealthCheck {
  String get name;
  Future<ZephyrHealthCheckResult> run();
}

// å†…å­˜å¥åº·æ£€æŸ¥
class ZephyrMemoryHealthCheck extends ZephyrHealthCheck {
  @override
  String get name => 'memory';
  
  @override
  Future<ZephyrHealthCheckResult> run() async {
    final memoryReport = ZephyrMemoryMetrics.generateReport();
    
    if (memoryReport.totalMemoryUsage > 100.0) {
      return ZephyrHealthCheckResult(
        status: ZephyrHealthStatus.unhealthy,
        message: 'Memory usage too high: ${memoryReport.totalMemoryUsage}MB',
      );
    }
    
    if (memoryReport.totalMemoryUsage > 50.0) {
      return ZephyrHealthCheckResult(
        status: ZephyrHealthStatus.degraded,
        message: 'Memory usage elevated: ${memoryReport.totalMemoryUsage}MB',
      );
    }
    
    return ZephyrHealthCheckResult(
      status: ZephyrHealthStatus.healthy,
      message: 'Memory usage normal: ${memoryReport.totalMemoryUsage}MB',
    );
  }
}

// æ¸²æŸ“æ€§èƒ½å¥åº·æ£€æŸ¥
class ZephyrRenderingHealthCheck extends ZephyrHealthCheck {
  @override
  String get name => 'rendering';
  
  @override
  Future<ZephyrHealthCheckResult> run() async {
    final renderingReport = ZephyrRenderingMetrics.generateReport();
    final worstWidgets = renderingReport.worstPerformingWidgets;
    
    if (worstWidgets.isNotEmpty) {
      return ZephyrHealthCheckResult(
        status: ZephyrHealthStatus.degraded,
        message: 'Some widgets have poor rendering performance: ${worstWidgets.join(', ')}',
      );
    }
    
    return ZephyrHealthCheckResult(
      status: ZephyrHealthStatus.healthy,
      message: 'All widgets render within acceptable time',
    );
  }
}
```

#### 3.2 é”™è¯¯ç›‘æ§
```dart
// é”™è¯¯ç›‘æ§ç³»ç»Ÿ
class ZephyrErrorMonitor {
  static final List<ZephyrErrorReport> _errors = [];
  static final Map<String, int> _errorCounts = {};
  
  static void recordError(ZephyrError error, StackTrace? stackTrace) {
    final report = ZephyrErrorReport(
      error: error,
      stackTrace: stackTrace,
      timestamp: DateTime.now(),
    );
    
    _errors.add(report);
    _errorCounts[error.code] = (_errorCounts[error.code] ?? 0) + 1;
    
    // å‘é€åˆ°é”™è¯¯è¿½è¸ªæœåŠ¡
    _sendToErrorTracking(report);
  }
  
  static List<ZephyrErrorReport> getRecentErrors({Duration? duration}) {
    final cutoff = duration != null 
        ? DateTime.now().subtract(duration)
        : DateTime.now().subtract(const Duration(hours: 24));
    
    return _errors.where((error) => error.timestamp.isAfter(cutoff)).toList();
  }
  
  static Map<String, int> getErrorCounts() {
    return Map.from(_errorCounts);
  }
  
  static List<ZephyrErrorReport> getCriticalErrors() {
    return _errors.where((error) => error.error.isCritical).toList();
  }
  
  static void _sendToErrorTracking(ZephyrErrorReport report) {
    // å®ç°é”™è¯¯è¿½è¸ªé›†æˆ
    debugPrint('Error tracked: ${report.error.code} - ${report.error.message}');
  }
  
  static ZephyrErrorReport generateSummary() {
    final recentErrors = getRecentErrors();
    final criticalErrors = getCriticalErrors();
    
    return ZephyrErrorReport(
      error: ZephyrError(
        code: 'ERROR_SUMMARY',
        message: 'Error summary generated',
        isCritical: criticalErrors.isNotEmpty,
      ),
      timestamp: DateTime.now(),
      metadata: {
        'totalErrors': recentErrors.length,
        'criticalErrors': criticalErrors.length,
        'uniqueErrorCodes': _errorCounts.length,
      },
    );
  }
}
```

### 4. ç›‘æ§ä»ªè¡¨æ¿

#### 4.1 å®æ—¶ç›‘æ§ä»ªè¡¨æ¿
```dart
// ç›‘æ§ä»ªè¡¨æ¿
class ZephyrMonitoringDashboard extends StatefulWidget {
  const ZephyrMonitoringDashboard({super.key});
  
  @override
  State<ZephyrMonitoringDashboard> createState() => _ZephyrMonitoringDashboardState();
}

class _ZephyrMonitoringDashboardState extends State<ZephyrMonitoringDashboard> {
  Timer? _updateTimer;
  ZephyrRenderingReport? _renderingReport;
  ZephyrMemoryReport? _memoryReport;
  ZephyrHealthReport? _healthReport;
  
  @override
  void initState() {
    super.initState();
    _updateReports();
    _updateTimer = Timer.periodic(const Duration(seconds: 5), (_) => _updateReports());
  }
  
  @override
  void dispose() {
    _updateTimer?.cancel();
    super.dispose();
  }
  
  void _updateReports() {
    setState(() {
      _renderingReport = ZephyrRenderingMetrics.generateReport();
      _memoryReport = ZephyrMemoryMetrics.generateReport();
      _healthReport = ZephyrHealthChecker.runChecks() as ZephyrHealthReport?;
    });
  }
  
  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: const Text('ZephyrUI Monitoring Dashboard'),
      ),
      body: SingleChildScrollView(
        padding: const EdgeInsets.all(16),
        child: Column(
          crossAxisAlignment: CrossAxisAlignment.start,
          children: [
            _buildHealthStatus(),
            const SizedBox(height: 24),
            _buildRenderingMetrics(),
            const SizedBox(height: 24),
            _buildMemoryMetrics(),
            const SizedBox(height: 24),
            _buildComponentUsage(),
          ],
        ),
      ),
    );
  }
  
  Widget _buildHealthStatus() {
    return Card(
      child: Padding(
        padding: const EdgeInsets.all(16),
        child: Column(
          crossAxisAlignment: CrossAxisAlignment.start,
          children: [
            const Text(
              'System Health',
              style: TextStyle(fontSize: 18, fontWeight: FontWeight.bold),
            ),
            const SizedBox(height: 16),
            if (_healthReport != null) ...[
              _buildHealthIndicator(_healthReport!.overallStatus),
              const SizedBox(height: 8),
              Text('Overall Status: ${_healthReport!.overallStatus.name}'),
              const SizedBox(height: 8),
              ..._healthReport!.results.entries.map((entry) {
                return Padding(
                  padding: const EdgeInsets.only(bottom: 4),
                  child: Text('${entry.key}: ${entry.value.status.name}'),
                );
              }),
            ] else ...[
              const Text('Loading health status...'),
            ],
          ],
        ),
      ),
    );
  }
  
  Widget _buildHealthIndicator(ZephyrHealthStatus status) {
    Color color;
    switch (status) {
      case ZephyrHealthStatus.healthy:
        color = Colors.green;
        break;
      case ZephyrHealthStatus.degraded:
        color = Colors.orange;
        break;
      case ZephyrHealthStatus.unhealthy:
        color = Colors.red;
        break;
    }
    
    return Container(
      width: 12,
      height: 12,
      decoration: BoxDecoration(
        color: color,
        shape: BoxShape.circle,
      ),
    );
  }
  
  Widget _buildRenderingMetrics() {
    return Card(
      child: Padding(
        padding: const EdgeInsets.all(16),
        child: Column(
          crossAxisAlignment: CrossAxisAlignment.start,
          children: [
            const Text(
              'Rendering Performance',
              style: TextStyle(fontSize: 18, fontWeight: FontWeight.bold),
            ),
            const SizedBox(height: 16),
            if (_renderingReport != null) ...[
              Text('Worst Performing Widgets:'),
              ..._renderingReport!.worstPerformingWidgets.map((widget) {
                return Padding(
                  padding: const EdgeInsets.only(bottom: 4),
                  child: Text('â€¢ $widget'),
                );
              }),
            ] else ...[
              const Text('Loading rendering metrics...'),
            ],
          ],
        ),
      ),
    );
  }
  
  Widget _buildMemoryMetrics() {
    return Card(
      child: Padding(
        padding: const EdgeInsets.all(16),
        child: Column(
          crossAxisAlignment: CrossAxisAlignment.start,
          children: [
            const Text(
              'Memory Usage',
              style: TextStyle(fontSize: 18, fontWeight: FontWeight.bold),
            ),
            const SizedBox(height: 16),
            if (_memoryReport != null) ...[
              Text('Total Memory Usage: ${_memoryReport!.totalMemoryUsage.toStringAsFixed(2)} MB'),
              Text('Total Objects: ${_memoryReport!.totalObjectCount}'),
            ] else ...[
              const Text('Loading memory metrics...'),
            ],
          ],
        ),
      ),
    );
  }
  
  Widget _buildComponentUsage() {
    final usageReport = ZephyrComponentUsageMetrics.generateReport();
    
    return Card(
      child: Padding(
        padding: const EdgeInsets.all(16),
        child: Column(
          crossAxisAlignment: CrossAxisAlignment.start,
          children: [
            const Text(
              'Component Usage',
              style: TextStyle(fontSize: 18, fontWeight: FontWeight.bold),
            ),
            const SizedBox(height: 16),
            Text('Total Component Usages: ${usageReport.totalComponentUsages}'),
            const SizedBox(height: 8),
            Text('Most Used Components:'),
            ...usageReport.mostUsedComponents.take(5).map((component) {
              return Padding(
                padding: const EdgeInsets.only(bottom: 4),
                child: Text('â€¢ $component'),
              );
            }),
          ],
        ),
      ),
    );
  }
}
```

## ğŸ“ˆ æ•°æ®æ¨¡å‹å®šä¹‰

### ç›‘æ§æ•°æ®æ¨¡å‹
```dart
// å¥åº·çŠ¶æ€æšä¸¾
enum ZephyrHealthStatus {
  healthy,
  degraded,
  unhealthy,
}

// å¥åº·æ£€æŸ¥ç»“æœ
class ZephyrHealthCheckResult {
  final ZephyrHealthStatus status;
  final String message;
  final Map<String, dynamic>? details;
  
  ZephyrHealthCheckResult({
    required this.status,
    required this.message,
    this.details,
  });
}

// å¥åº·æŠ¥å‘Š
class ZephyrHealthReport {
  final Map<String, ZephyrHealthCheckResult> results;
  final ZephyrHealthStatus overallStatus;
  final DateTime timestamp;
  
  ZephyrHealthReport({
    required this.results,
    required this.overallStatus,
    required this.timestamp,
  });
}

// æ¸²æŸ“æ€§èƒ½æŠ¥å‘Š
class ZephyrRenderingReport {
  final Map<String, double> averageFrameTimes;
  final Map<String, double> averageBuildTimes;
  final List<String> worstPerformingWidgets;
  final DateTime timestamp;
  
  ZephyrRenderingReport({
    required this.averageFrameTimes,
    required this.averageBuildTimes,
    required this.worstPerformingWidgets,
    required this.timestamp,
  });
}

// å†…å­˜æŠ¥å‘Š
class ZephyrMemoryReport {
  final double totalMemoryUsage;
  final int totalObjectCount;
  final Map<String, double> memoryByCategory;
  final Map<String, int> objectCountsByType;
  final DateTime timestamp;
  
  ZephyrMemoryReport({
    required this.totalMemoryUsage,
    required this.totalObjectCount,
    required this.memoryByCategory,
    required this.objectCountsByType,
    required this.timestamp,
  });
}

// é”™è¯¯æŠ¥å‘Š
class ZephyrErrorReport {
  final ZephyrError error;
  final StackTrace? stackTrace;
  final DateTime timestamp;
  final Map<String, dynamic>? metadata;
  
  ZephyrErrorReport({
    required this.error,
    this.stackTrace,
    required this.timestamp,
    this.metadata,
  });
}
```

## ğŸ¯ ç›‘æ§ç­–ç•¥

### 1. å®æ—¶ç›‘æ§
- **æ¸²æŸ“æ€§èƒ½**: å®æ—¶ç›‘æ§ç»„ä»¶æ¸²æŸ“æ—¶é—´å’Œå¸§ç‡
- **å†…å­˜ä½¿ç”¨**: ç›‘æ§å†…å­˜ä½¿ç”¨è¶‹åŠ¿å’Œæ³„æ¼æ£€æµ‹
- **é”™è¯¯è¿½è¸ª**: å®æ—¶æ•è·å’ŒæŠ¥å‘Šåº”ç”¨é”™è¯¯

### 2. å‘Šè­¦æœºåˆ¶
- **æ€§èƒ½å‘Šè­¦**: å½“æ¸²æŸ“æ—¶é—´è¶…è¿‡16msæ—¶è§¦å‘
- **å†…å­˜å‘Šè­¦**: å½“å†…å­˜ä½¿ç”¨è¶…è¿‡100MBæ—¶è§¦å‘
- **é”™è¯¯å‘Šè­¦**: å½“å‘ç”Ÿå…³é”®é”™è¯¯æ—¶ç«‹å³è§¦å‘

### 3. æ•°æ®æ”¶é›†
- **æœ¬åœ°å­˜å‚¨**: åœ¨æœ¬åœ°å­˜å‚¨ç›‘æ§æ•°æ®
- **è¿œç¨‹åŒæ­¥**: å®šæœŸåŒæ­¥åˆ°è¿œç¨‹åˆ†æå¹³å°
- **æ•°æ®èšåˆ**: æ”¯æŒæ•°æ®èšåˆå’Œåˆ†æ

### 4. å¯è§†åŒ–å±•ç¤º
- **å®æ—¶ä»ªè¡¨æ¿**: æä¾›å®æ—¶ç›‘æ§æ•°æ®å±•ç¤º
- **å†å²è¶‹åŠ¿**: æ”¯æŒå†å²æ•°æ®è¶‹åŠ¿åˆ†æ
- **æ€§èƒ½æŠ¥å‘Š**: è‡ªåŠ¨ç”Ÿæˆæ€§èƒ½åˆ†ææŠ¥å‘Š

é€šè¿‡è¿™ä¸ªå®Œæ•´çš„DDDåˆ†å±‚æ¶æ„è®¾è®¡å’Œå¯è§‚æµ‹æ€§ä½“ç³»ï¼ŒZephyrUIå°†å…·å¤‡ä¼ä¸šçº§çš„æ¶æ„è´¨é‡å’Œç›‘æ§èƒ½åŠ›ï¼Œç¡®ä¿ç³»ç»Ÿçš„ç¨³å®šæ€§ã€å¯ç»´æŠ¤æ€§å’Œå¯è§‚æµ‹æ€§ã€‚

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0  
**æœ€åæ›´æ–°**: 2024å¹´  
**åˆ¶å®šäºº**: æ¶æ„å¸ˆå›¢é˜Ÿ  
**å®¡æ‰¹çŠ¶æ€**: å¾…æ‰¹å‡†